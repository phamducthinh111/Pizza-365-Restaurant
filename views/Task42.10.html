<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Task 42.10 Update</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <!-- Data Table-->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.24/css/dataTables.bootstrap4.min.css">
    <script src="https://cdn.datatables.net/1.10.24/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.24/js/dataTables.bootstrap4.min.js"></script>
</head>
<body>
    <!-- Menu -->
    <div class="container ">
        <div class="row">
            <div class="col-12">
                <nav class="navbar fixed-top navbar-expand-lg navbar-light bg-warning">
                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo03" aria-controls="navbarTogglerDemo03" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="collapse navbar-collapse" id="navbarNav">
                      <ul class="navbar-nav nav-fill w-100 ">
                        <li class="nav-item active">
                          <a class="nav-link" href="#">Trang chủ</a>
                        </li>
                        <li class="nav-item">
                          <a class="nav-link" href="#id-combo">Combo</a>
                        </li>
                        <li class="nav-item">
                          <a class="nav-link" href="#id-about">About</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#id-guidonhang">Gửi đơn hàng</a>
                        </li>
                      </ul>
                    </div>
                  </nav>
            </div>
        </div>
    </div>
    <!-- Carousel  -->
    <div class="container" style="padding: 120px 0 50px 0;" >
        <div class="text-warning">
            <h1><b>PIZZA 365 <br> <span style="font-style: italic ;font-size: 25px">Truly italian!</span> </b></h1>
        </div>
        
        <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
            <ol class="carousel-indicators">
              <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
              <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
              <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
              <li data-target="#carouselExampleIndicators" data-slide-to="3"></li>
            </ol>
            <div class="carousel-inner">
              <div class="carousel-item active">
                <img class="d-block w-100" src="images/1.jpg" alt="First slide">
              </div>
              <div class="carousel-item">
                <img class="d-block w-100" src="images/2.jpg" alt="Second slide">
              </div>
              <div class="carousel-item">
                <img class="d-block w-100" src="images/3.jpg" alt="Third slide">
              </div>
              <div class="carousel-item">
                <img class="d-block w-100" src="images/4.jpg" alt="4 slide">
              </div>
            </div>
            <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
              <span class="carousel-control-prev-icon" aria-hidden="true"></span>
              <span class="sr-only">Previous</span>
            </a>
            <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
              <span class="carousel-control-next-icon" aria-hidden="true"></span>
              <span class="sr-only">Next</span>
            </a>
          </div>
    </div>
    <!-- Giới thiệu  -->
    <div class="container">
        <div class=" text-center p-4 ">
            <h2><b class="p-2 border-bottom border-warning text-warning">Tại sao lại Pizza 365:</b></h2>
        </div>
        <div class="row">
            <div class="col-sm-3 border border-warning " style="background-color:lightgoldenrodyellow ;padding: 25px;">
                 <h3>Đa dạng</h3>
                <p style="font-weight: bold;padding-top: 10px;"> Số lượng pizza đa dạng, có đầy đủ các loại pizza đang hót nhất hiện nay</p>
            </div>
            <div class="col-sm-3 border border-warning" style="background-color:yellow ;padding: 25px;">
                <h3>Chất lượng</h3>
                <p style="font-weight: bold;padding-top: 10px;"> Nguyên liệu sạch 100% rõ nguồn gốc, quy trình chế biến đảm bảo vệ sinh an toàn thực phẩm </p>
            </div>
            <div class="col-sm-3 border border-warning" style="background-color:lightsalmon ;padding: 25px;">
                <h3>Hương vị</h3>
                <p style="font-weight: bold;padding-top: 10px;"> Đảm bảo hương vị ngon, độc, lạ mà bạn chỉ có thể trải nghiệm từ Pizza 365.</p>
            </div>
            <div class="col-sm-3 border border-warning" style="background-color:orange ;padding: 25px;">
                <h3>Dịch vụ</h3>
                <p style="font-weight: bold;padding-top: 10px;"> Nhân viên thân thiên, nhà hàng hiện đại. Dịch vụ giao hàng nhanh chất lượng, tân tiến.</p>
            </div>
        </div>
    </div>
    <!-- Size Pizza  -->
    <div class="container" id="id-combo">
        <div class=" text-center p-4 text-warning ">
            <h2><b class="p-2 border-bottom border-warning ">Chọn size pizza</b></h2>
            <p style="padding-top: 5px;">Chọn combo pizza phù hợp với nhu cầu của bạn</p>
        </div>
        <div class="row">
            <div class="col-sm-4">
                <div class="card text-center">
                    <div class="card-header bg-warning">
                      <h3>S (small)</h3>
                    </div>
                    <div class="card-body">
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item">Đường kính: <b>20cm</b></li>
                            <li class="list-group-item">Sườn nướng: <b>10</b></li>
                            <li class="list-group-item">Salad <b>25g: </b></li>
                            <li class="list-group-item">Nước ngọt: <b>2</b></li>
                            <li class="list-group-item">
                              <h1><b>150.000</b></h1> VND
                            </li>
                        </ul>
                    </div>
                    <div class="card-footer text-muted">
                      <button id="btn-small" class="btn btn-warning btn-block" data-is-selected-menu = "N"><b>Chọn</b></button>
                    </div>
                </div>
            </div>
            <div class="col-sm-4">
                <div class="card text-center">
                    <div class="card-header bg-warning">
                      <h3>M (medium)</h3>
                    </div>
                    <div class="card-body">
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item">Đường kính: <b>25cm</b></li>
                            <li class="list-group-item">Sườn nướng: <b>4</b></li>
                            <li class="list-group-item">Salad: <b>300g </b></li>
                            <li class="list-group-item">Nước ngọt: <b>3</b></li>
                            <li class="list-group-item">
                              <h1><b>200.000</b></h1> VND
                            </li>
                        </ul>
                    </div>
                    <div class="card-footer text-muted">
                      <button id="btn-medium" class="btn btn-warning btn-block" data-is-selected-menu = "N"><b>Chọn</b></button>
                    </div>
                </div>
            </div>
            <div class="col-sm-4">
                <div class="card text-center">
                    <div class="card-header bg-warning">
                      <h3>L (large)</h3>
                    </div>
                    <div class="card-body">
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item">Đường kính: <b>30cm</b></li>
                            <li class="list-group-item">Sườn nướng: <b>8</b></li>
                            <li class="list-group-item">Salad <b>500 </b></li>
                            <li class="list-group-item">Nước ngọt: <b>4</b></li>
                            <li class="list-group-item">
                              <h1><b>250.000</b></h1> VND
                            </li>
                        </ul>
                    </div>
                    <div class="card-footer text-muted">
                      <button id="btn-large" class="btn btn-warning btn-block" data-is-selected-menu = "N"><b>Chọn</b></button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Chọn loại Pizza  -->
    <div class="container" id="id-about">
        <div class=" text-center p-4 text-warning ">
            <h2><b class="p-2 border-bottom border-warning ">Chọn loại pizza</b></h2>
        </div>
        <div class="row">
            <div class="col-sm-4">
                <div class="card" style="width: 22rem;">
                    <img class="card-img-top" src="images/seafood.jpg" alt="Card image cap">
                    <div class="card-body">
                      <h5 class="card-title">OCEAN MANIA</h5>
                      <p class="card-text">PIZZA HẢI SẢN XỐT MAYONNAISE</p>
                      <p class="card-text">Xốt Cà Chua, Phô Mai Mozzarella, Tôm, Mực, Thanh cua, Hành tây.</p>
                      <button id="btn-pizza-ocean" href="#" class="btn btn-warning btn-block" data-is-selected-pizza = "N"><b>Chọn</b></button>
                    </div>
                  </div>
            </div>
            <div class="col-sm-4">
                <div class="col-sm-4">
                    <div class="card" style="width: 22rem;">
                        <img class="card-img-top" src="images/hawaiian.jpg" alt="Card image cap">
                        <div class="card-body">
                          <h5 class="card-title">HAWAIIAN</h5>
                          <p class="card-text">PIZZA DĂM BÔNG DỨA KIỂU HAWAII</p>
                          <p class="card-text">Xốt Cà Chua, Phô Mai Mozzarella, Thịt Dăm Bông, Thơm.</p>
                          <button id="btn-pizza-hawaii" href="#" class="btn btn-warning btn-block" data-is-selected-pizza = "N"><b>Chọn</b></button>
                        </div>
                      </div>
                </div>
            </div>
            <div class="col-sm-4">
                <div class="col-sm-4">
                    <div class="card" style="width: 22rem;">
                        <img class="card-img-top" src="images/bacon.jpg" alt="Card image cap">
                        <div class="card-body">
                          <h5 class="card-title">CHEESY CHICKEN BACON</h5>
                          <p class="card-text">PIZZA GÀ PHÔ MAI THỊT HEO XÔNG KHÓI</p>
                          <p class="card-text">Xốt Phô Mai,Thịt Gà, Thịt Heo Muối, Phô Mai Mozzarella, Cà Chua.</p>
                          <button id="btn-pizza-bacon" href="#" class="btn btn-warning btn-block" data-is-selected-pizza = "N"><b>Chọn</b></button>
                        </div>
                      </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Chọn đồ uống  -->
    <div class="container">
      <div class=" text-center p-4 ">
        <h2><b class="p-2 border-bottom border-warning text-warning">Chọn đồ uống</b></h2>
      </div>
      <div class="form-group">
        <select id="sl-douong"  class="form-control" name="" id="">
          <option value="0">Tất cả các loại nước uống</option>
        </select>
      </div>
    </div>
    <!-- Gửi đơn hàng  -->
    <div class="container" id="id-guidonhang">
      <div class=" text-center p-4 ">
        <h2><b class="p-2 border-bottom border-warning text-warning">Gửi đơn hàng</b></h2>
      </div>
      <div class="form-group">
        <label for="">Tên</label>
        <input type="text" class="form-control" placeholder="Nhập tên" id="ip-ten">
      </div>
      <div class="form-group">
        <label for="">Email</label>
        <input type="text" class="form-control" placeholder="Nhập email" id="ip-email">
      </div>
      <div class="form-group">
        <label for="">Số điện thoại</label>
        <input type="text" class="form-control" placeholder="Nhập số điện thoại" id="ip-phone">
      </div>
      <div class="form-group">
        <label for="">Địa chỉ</label>
        <input type="text" class="form-control" placeholder="Nhập địa chỉ" id="ip-diachi">
      </div>
      <div class="form-group">
        <label for="">Mã giảm giá</label>
        <input type="text" class="form-control" placeholder="Nhập mã giảm giá" id="ip-magiamgia">
      </div>
      <div class="form-group">
        <label for="">Lời nhắn</label>
        <input type="text" class="form-control" placeholder="Nhập lời nhắn" id="ip-loinhan">
      </div>
      <div class="form-group">
        <button class="btn btn-warning btn-block" id="btn-gui"> Gửi</button>
      </div>
    </div>
    <!-- footer  -->
    <div class="container-fluid bg-warning p-5 mt-5">
      <div class="row text-center">
        <div class="col-sm-12">
          <h4 class="m-2">Footer</h4>
          <a href="#" class="btn btn-dark m-3"><i class="fa fa-arrow-up"></i>To the top</a>
          <div class="m-2">
            <i class="fab fa-facebook w3-hover-opacity"></i>
            <i class="fab fa-instagram-square"></i>
            <i class="fab fa-snapchat-square"></i>
            <i class="fab fa-pinterest-p"></i>
            <i class="fab fa-twitter"></i>
            <i class="fab fa-linkedin-in"></i>
          </div>
        </div>
      </div>
    </div>
    <!-- Modal gửi đơn hàng -->
    <div id="modal-gui-don-hang" class="modal fade bd-example-modal-xl" tabindex="-1" role="dialog">
      <div class="modal-dialog modal-xl" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Thông tin đơn hàng</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <div class="form-group">
              <label for="">Họ và tên</label>
              <input class="form-control" type="text" name="" id="ip-modal-ten">
            </div>
            <div class="form-group">
              <label for="">Số điện thoại</label>
              <input class="form-control" type="text" name="" id="ip-modal-phone">
            </div>
            <div class="form-group">
              <label for="">Địa chỉ</label>
              <input class="form-control" type="text" name="" id="ip-modal-diachi">
            </div>
            <div class="form-group">
              <label for="">Lời nhắn</label>
              <input class="form-control" type="text" name="" id="ip-modal-loinhan">
            </div>
            <div class="form-group">
              <label for="">Mã giảm giá</label>
              <input class="form-control" type="text" name="" id="ip-modal-voucher">
            </div>
            <div class="form-group">
              <label for="">Thông tin chi tiết</label>
              <textarea class="form-control" name="" id="text--modal-thongtin-chitiet" ></textarea>
            </div>
          </div>
          <div class="modal-footer">
            <button id="btn-quaylai" type="button" class="btn btn-danger" style="padding-left:30px;padding-right:30px;border-left-width: 30px;border-right-width: 30px;">Quay lại</button>
            <button id="btn-taodon" type="button" class="btn btn-warning" style="padding-left:30px;padding-right:30px;border-left-width: 30px;border-right-width: 30px;">Tạo đơn</button>
          </div>
        </div>
      </div>
    </div>
    <!-- Modal tạo đơn hàng thành công -->
    <div id="modal-tao-don-hang" class="modal fade bd-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content bg-warning">
          <div class="modal-header">
            <h5 class="modal-title">Cảm ơn bạn đã đặt hàng tại Pizza 365. Mã đơn hàng của bạn là</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <div class="row form-group">
              <div class="col-sm-3">
                <label for=""><b>Mã đơn hàng: </b> </label>
              </div>
              <div class="col-sm-9">
                <input class="form-control" type="text" name="" id="input-modal-id">
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
</body>
<script>
"use strict";
/*** REGION 1 - Global variables - Vùng khai báo biến, hằng số, tham số TOÀN CỤC */
  const gBASE_URL = "/devcamp-pizza365/orders";

  const gREQUEST_STATUS_OK = 200;
  const gREQUEST_CREATE_OK = 201; // status 201 tao thanh cong
  const gREQUEST_READY_STATUS_FINISH_AND_OK = 4;

  // khai báo biến toàn cục chưa combo pizza được chọn
  var gComboDuocChon = 0;
  // khai báo biến toàn cục chưa loại pizza được chọn
  var gPizzaDuocChon = 0;
/*** REGION 2 - Vùng gán / thực thi hàm xử lý sự kiện cho các elements */
  $(document).ready(function() {
    // hàm chọn Combo Pizza
    // S
    $("#btn-small").on("click",onBtnSmallClick)
    // M
    $("#btn-medium").on("click",onBtnMediumClick)
    // L
    $("#btn-large").on("click",onBtnLargeClick)

    // hàm chọn loại Pizza
    // OCEAN
    $("#btn-pizza-ocean").on("click",onBtnPizzaOceanClick)
    // HAWAIIAN
    $("#btn-pizza-hawaii").on("click",onBtnPizzaHawaiiClick)
    // CHICKEN
    $("#btn-pizza-bacon").on("click",onBtnPizzaBaconClick)

    // hàm load lại trang
    onPageLoading()
    
    // hàm xử lý khi nút gửi được click
    $("#btn-gui").on("click",onBtnGuiClick);
    // hàm xử lý khi nút tạo đơn được click
    $("#btn-taodon").on("click",onBtnTaoDonClick)
  })
  

/*** REGION 3 - Event handlers - Vùng khai báo các hàm xử lý sự kiện */  
  function onPageLoading() {
    onLoadDataDrinkToSelect();
  }
  // hàm xử lý sự kiện khi nút Chọn Combo Click (S)
  function onBtnSmallClick() {
    doiMauNutChonComBoPizza("small");
    var vComBoSmall = getPlanMenu("S", 20, 2, 200, 2, 150000);
   console.log(vComBoSmall.duongKinhCM) 
   // vComBoSmall.displayInConsoleLog()
  }
  // hàm xử lý sự kiện khi nút Chọn Combo Click (M)
  function onBtnMediumClick() {
    doiMauNutChonComBoPizza("medium");
    var vComBoMedium = getPlanMenu("M", 25, 4, 300, 3, 200000);
    vComBoMedium.displayInConsoleLog()
  }
  // hàm xử lý sự kiện khi nút Chọn Combo Click (L)
  function onBtnLargeClick() {
    doiMauNutChonComBoPizza("large");
    var vComboLarge = getPlanMenu("L", 30, 8, 500, 4, 250000);
    vComboLarge.displayInConsoleLog()
  }

  // hàm xử lý sự kiện khi nút Chọn loại Pizza Click (OCEAN)
  function onBtnPizzaOceanClick() {
   var vPizzaOcean = doiMauNutChonLoaiPizza("ocean");
  }
  // hàm xử lý sự kiện khi nút Chọn loại Pizza Click (HAWAIIAN)
  function onBtnPizzaHawaiiClick() {
    var vPizzaHawaii = doiMauNutChonLoaiPizza("hawaii");
  }
  // hàm xử lý sự kiện khi nút Chọn loại Pizza Click (BACON)
  function onBtnPizzaBaconClick() {
    var vPizzaBacon = doiMauNutChonLoaiPizza("bacon");
    
  }
  // hàm xử lý khí nút gửi được click
  function onBtnGuiClick() {
    
    // bước 1: kiểm tra dữ liệu
    var vUserOrder = thuThapDuLieuUser();
    // bước 2 : validate
    var vDuLieuHopLe = kiemTraDuLieu(vUserOrder);
    if(vDuLieuHopLe) {
      // bước 3: hiển thị giữ liệu vào modal
      hienThiDuLieuToMoDal(vUserOrder)
    }
  }
  // hàm tạo đơn đc click
  function onBtnTaoDonClick() {
    // ẩn modal gửi đơn đi
    $("#modal-gui-don-hang").modal("hide");
    // hiện modal tạo đơn thành công
    // B1: Thu thập dữ liệu
    var vUserOrder = thuThapDuLieuUser();
    // B2: kiểm tra dữ liệu( bỏ qua)
    // B3: Gọi API tạo đơn hàng mới
    $.ajax({
      url : gBASE_URL,
      type: "POST",
      data: JSON.stringify(vUserOrder),
      contentType: "application/json;charset=UTF-8",
      success: function(res) {
        //B4: Hiển thị dữ liệu
        console.log(res)
        hienThiDuLieuToMoDalTaoDon(res)
      },
      error: function(error) {
        alert(error.responseText)
      }
    })
  }

/*** REGION 4 - Common funtions - Vùng khai báo hàm dùng chung trong toàn bộ chương trình*/
  // hàm đổi màu nút chọn Combo Pizza
  function doiMauNutChonComBoPizza(paramSelect) {
    var vBtnSmall = $("#btn-small");
    var vBtnMedium = $("#btn-medium");
    var vBtnLarge = $("#btn-large");

    if(paramSelect == "small"){
      vBtnSmall.attr("data-is-selected-menu","Y");
      vBtnSmall.toggleClass("btn-warning");
      vBtnSmall.addClass("btn-info");

      vBtnMedium.attr("data-is-selected-menu","N");
      vBtnMedium.toggleClass("btn-warning");
      vBtnMedium.addClass("btn-warning");

      vBtnLarge.attr("data-is-selected-menu","N");
      vBtnLarge.toggleClass("btn-warning");
      vBtnLarge.addClass("btn-warning");
    }
    else if(paramSelect == "medium") {
      vBtnSmall.attr("data-is-selected-menu","N");
      vBtnSmall.toggleClass("btn-warning");
      vBtnSmall.addClass("btn-warning");
      
      vBtnMedium.attr("data-is-selected-menu","Y");
      vBtnMedium.toggleClass("btn-warning");
      vBtnMedium.addClass("btn-info");

      vBtnLarge.attr("data-is-selected-menu","N");
      vBtnLarge.toggleClass("btn-warning");
      vBtnLarge.addClass("btn-warning");
    }
    else if(paramSelect == "large") {
      vBtnSmall.attr("data-is-selected-menu","N");
      vBtnSmall.toggleClass("btn-warning");
      vBtnSmall.addClass("btn-warning");
      
      vBtnMedium.attr("data-is-selected-menu","N");
      vBtnMedium.toggleClass("btn-warning");
      vBtnMedium.addClass("btn-warning");

      vBtnLarge.attr("data-is-selected-menu","Y");
      vBtnLarge.toggleClass("btn-warning");
      vBtnLarge.addClass("btn-info");
    }
    
  }
  // hàm đổi màu nút chọn loại Pizza 
  function doiMauNutChonLoaiPizza(paramSelect) {
    var vBtnPizzaOcean = $("#btn-pizza-ocean");
    var vBtnPizzaHawaii = $("#btn-pizza-hawaii");
    var vBtnPizzaBacon = $("#btn-pizza-bacon");

    if(paramSelect == "ocean"){
      vBtnPizzaOcean.attr("data-is-selected-pizza","Y");
      vBtnPizzaOcean.toggleClass("btn-warning");
      vBtnPizzaOcean.addClass("btn-info");

      vBtnPizzaHawaii.attr("data-is-selected-pizza","N");
      vBtnPizzaHawaii.toggleClass("btn-warning");
      vBtnPizzaHawaii.addClass("btn-warning");

      vBtnPizzaBacon.attr("data-is-selected-pizza","N");
      vBtnPizzaBacon.toggleClass("btn-warning");
      vBtnPizzaBacon.addClass("btn-warning");
    }
    else if(paramSelect == "hawaii") {
      vBtnPizzaOcean.attr("data-is-selected-pizza","N");
      vBtnPizzaOcean.toggleClass("btn-warning");
      vBtnPizzaOcean.addClass("btn-warning");
      
      vBtnPizzaHawaii.attr("data-is-selected-pizza","Y");
      vBtnPizzaHawaii.toggleClass("btn-warning");
      vBtnPizzaHawaii.addClass("btn-info");

      vBtnPizzaBacon.attr("data-is-selected-pizza","N");
      vBtnPizzaBacon.toggleClass("btn-warning");
      vBtnPizzaBacon.addClass("btn-warning");
    }
    else if(paramSelect == "bacon") {
      vBtnPizzaOcean.attr("data-is-selected-pizza","N");
      vBtnPizzaOcean.toggleClass("btn-warning");
      vBtnPizzaOcean.addClass("btn-warning");
      
      vBtnPizzaHawaii.attr("data-is-selected-pizza","N");
      vBtnPizzaHawaii.toggleClass("btn-warning");
      vBtnPizzaHawaii.addClass("btn-warning");

      vBtnPizzaBacon.attr("data-is-selected-pizza","Y");
      vBtnPizzaBacon.toggleClass("btn-warning");
      vBtnPizzaBacon.addClass("btn-info");
    }
  }
  
  // hàm load dữ liệu đồ uống
  function onLoadDataDrinkToSelect() {
    $.ajax({
      url: "/devcamp-pizza365/drinks",
      type: "GET",
      data: "json",
      success: function(resDrinkObj) {
        var vArrayDrink = resDrinkObj.data
        for (let index = 0; index < vArrayDrink.length; index++) {
          $("#sl-douong").append($("<option>",{
            value:vArrayDrink[index].maNuocUong,
            text: vArrayDrink[index].tenNuocUong
          }));   
        };
      },
      error: function(error) {
        alert(error.responseText)
      }   
    });
  }
  // hàm chọn kích cỡ combo pizza
  function getPlanMenu(paramMenuName,paramDuongKinh,paramSuonNuong,paramSaladGr,paramDrink,paramPriceVND) {
  var vComBoPizza = {
    menuName: paramMenuName,
    duongKinhCM: paramDuongKinh,
    suongNuong: paramSuonNuong,
    saladGr: paramSaladGr,
    drink: paramDrink,
    priceVND: paramPriceVND,
  
    displayInConsoleLog() {
      console.log("%cPLAN MENU COMBO - .........", "color:blue");
      console.log(this.menuName); //this = "đối tượng này"
      console.log("duongKinhCM: " + this.duongKinhCM);
      console.log("suongNuong: " + this.suongNuong);
      console.log("saladGr: " + this.saladGr);
      console.log("drink:" + this.drink);
      console.log("priceVND: " + this.priceVND);
    }
  }
  return vComBoPizza
}
  // thu thập dữ liệu User gửi đơn hàng
  function thuThapDuLieuUser() {
    // truy xuất dữ liệu combo Pizza (S,M,L)
    var vBtnSmall = $("#btn-small").attr("data-is-selected-menu");
    var vBtnMedium = $("#btn-medium").attr("data-is-selected-menu");
    var vBtnLarge = $("#btn-large").attr("data-is-selected-menu");
    
    if(vBtnSmall === "Y") {
    gComboDuocChon = getPlanMenu("S", 20, 2, 200, 2, 150000);
    }
    else if(vBtnMedium === "Y") {
      gComboDuocChon = getPlanMenu("M", 25, 4, 300, 3, 200000);
    }
    else if(vBtnLarge === "Y") {
      gComboDuocChon = getPlanMenu("L", 30, 8, 500, 4, 250000);
   }
   // truy xuất dữ liệu loại Pizza
    var vBtnPizzaOcean = $("#btn-pizza-ocean").attr("data-is-selected-pizza");
    var vBtnPizzaHawaii = $("#btn-pizza-hawaii").attr("data-is-selected-pizza");
    var vBtnPizzaBacon = $("#btn-pizza-bacon").attr("data-is-selected-pizza");
   
    if(vBtnPizzaOcean === "Y") {
      gPizzaDuocChon = "OCEAN MANIA" ; 
    }
    else if(vBtnPizzaHawaii === "Y") {
      gPizzaDuocChon = "HAWAIIAN" ;
    }
    else if(vBtnPizzaBacon === "Y") {
      gPizzaDuocChon = "CHEESY CHICKEN BACON";
   };
   // truy xuất dữ liệu đồ uống
   var vDrinkDuocChon = $("#sl-douong").val();
   // truy xuất dữ liệu thông tin user order
   var vIpTen = $("#ip-ten").val().trim();
   var vIpEmail = $("#ip-email").val().trim();
   var vIpPhone = parseInt($("#ip-phone").val().trim());
   var vIpDiaChi = $("#ip-diachi").val().trim();
   var vIpMaGiamGia = $("#ip-magiamgia").val().trim();
   var vIpLoiNhan = $("#ip-loinhan").val().trim();
   // biến chứa discount
   var vDiscount = 0;
   if(vIpMaGiamGia != "") {
    vDiscount = goiAPIKiemTraVoucher(vIpMaGiamGia);
   }
   
    var vUserOrder = {
      menuDuocChon : gComboDuocChon,
      loaiPizza: gPizzaDuocChon,
      loaiNuocUong: vDrinkDuocChon,
      hoVaTen: vIpTen,
      email: vIpEmail,
      dienThoai: vIpPhone,
      diaChi: vIpDiaChi,
      voucher: vIpMaGiamGia,
      loiNhan: vIpLoiNhan,
      discount :vDiscount,

      priceAnnualVND() {
        var vSoTienPhaiTra = this.menuDuocChon.priceVND * (1 - vDiscount / 100);
        return vSoTienPhaiTra
      }
    }
    return vUserOrder
  }
  function goiAPIKiemTraVoucher(paramVoucher) {
    var vDiscount = 0;
    $.ajax({
      url: "/devcamp-pizza365/voucher_detail/" + paramVoucher,
      async: false,
      type: "GET",
      success: function(res){
        vDiscount = res.data.phanTramGiamGia;
      },
      error: function(error){
        alert(error.responseText)
      }
    });
    return vDiscount; 
  
  /* "use strict";
  const vBASE_URL = "http://203.171.20.210:8080/devcamp-pizza365/voucher_detail/";
  // một số mã đúng để test: 95531, 81432,...lưu ý test cả mã sai
  // nếu mã giảm giấ đã nhập, tạo xmlHttp  request và gửi về server
  var vXmlHttp = new XMLHttpRequest();
  vXmlHttp.open("GET", vBASE_URL + "/" + paramVoucher, false);
  vXmlHttp.send(null);
  var vStatusCode = vXmlHttp.status;
    if (vStatusCode == gREQUEST_STATUS_OK) { // restFullAPI successful
      // nhận lại response dạng JSON ở xmlHttp.responseText và chuyển thành object
      var vVoucherObj = JSON.parse(vXmlHttp.responseText);
      var vDiscount = vVoucherObj.phanTramGiamGia;
    }
    else {
      // không nhận lại được data do vấn đề gì đó: khả năng mã voucher ko dúng
      alert("Không tìm thấy voucher ");
      return paramVoucher
    }
    return vDiscount; */
}

  // kiểm tra dữ liệu
  function kiemTraDuLieu(paramOrderObj) {
    if(paramOrderObj.menuDuocChon.menuName == "") {
      alert("Bạn chưa chọn Combo Pizza !!!");
      return false
    }
    if(paramOrderObj.loaiPizza == "") {
      alert("Bạn chưa chọn loại Pizza !!!")
      return false
    }
    if(paramOrderObj.loaiNuocUong === "0") {
      alert("Bạn chưa chọn loại nước uống !!!");
      return false
    }
    if(paramOrderObj.hoVaTen == "") {
      alert("Bạn chưa nhập Họ và Tên !!!");
      return false
    }
    if(!kiemTraEmail(paramOrderObj.email)) {
      alert("Email không đúng định dạng");
      return false;
    }
    if(isNaN(paramOrderObj.dienThoai)) {
      alert("Số điện thoại không được để trống và phải là số !!!")
      return false
    }
    if(paramOrderObj.diaChi == "") {
      alert("Bạn chưa nhập địa chị giao hàng !!!");
      return false
    } 
    return true
  }
  function kiemTraEmail(paramEmail) {
    const vValidateEmail = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
    return vValidateEmail.test(String(paramEmail).toLowerCase())
  }
  // hiện thị giữu liệu vào modal gửi đơn hàng
  function hienThiDuLieuToMoDal(paramOrderObj) {  
    $("#modal-gui-don-hang").modal("show");
    $("#ip-modal-ten").val(paramOrderObj.hoVaTen);
    $("#ip-modal-phone").val(paramOrderObj.dienThoai);
    $("#ip-modal-diachi").val(paramOrderObj.diaChi);
    $("#ip-modal-loinhan").val(paramOrderObj.loiNhan);
    $("#ip-modal-voucher").val(paramOrderObj.voucher);
    $("#text--modal-thongtin-chitiet").val("Xác nhận: " +  paramOrderObj.hoVaTen + ", " + paramOrderObj.dienThoai + ", " + paramOrderObj.diaChi + "\n" 
                                          + "Menu: " + paramOrderObj.menuDuocChon.menuName + " , " + "Sườn nướng: " + paramOrderObj.menuDuocChon.suongNuong + " , " + "Nước: " + paramOrderObj.menuDuocChon.drink + " ,..."  + "\n" 
                                          + "Loại Pizza: " + paramOrderObj.loaiPizza + " , Giá: " + paramOrderObj.menuDuocChon.priceVND + " vnđ , Mã giảm giá: " + paramOrderObj.voucher  + "\n"
                                          + "Phải thanh toán: " + paramOrderObj.priceAnnualVND() + " vnđ, " + " giảm giá: " + paramOrderObj.discount +"%"
                                          );
                                          
  }
  
  // hiển thị giữ liệu vào modal tạo đơn hàng
  function hienThiDuLieuToMoDalTaoDon(paramOrderObj) {
    $("#modal-tao-don-hang").modal("show");
    

    // truy xuất dữ liệu thông tin user order
    var vDrinkDuocChon = $("#sl-douong").val();
    var vIpTen = $("#ip-ten").val().trim();
    var vIpEmail = $("#ip-email").val().trim();
    var vIpPhone = parseInt($("#ip-phone").val().trim());
    var vIpDiaChi = $("#ip-diachi").val().trim();
    var vIpMaGiamGia = $("#ip-magiamgia").val().trim();
    var vIpLoiNhan = $("#ip-loinhan").val().trim();

    paramOrderObj.kichCo = gComboDuocChon.menuName;
    paramOrderObj.duongKinh = gComboDuocChon.duongKinhCM;
    paramOrderObj.suon = gComboDuocChon.suongNuong;
    paramOrderObj.salad = gComboDuocChon.saladGr;
    paramOrderObj.loaiPizza = gPizzaDuocChon;
    paramOrderObj.idVourcher = vIpMaGiamGia;
    paramOrderObj.idLoaiNuocUong = vDrinkDuocChon;
    paramOrderObj.soLuongNuoc = gComboDuocChon.drink;
    paramOrderObj.hoTen = vIpTen;
    paramOrderObj.thanhTien = gComboDuocChon.priceVND;
    paramOrderObj.email = vIpEmail;
    paramOrderObj.soDienThoai = vIpPhone;
    paramOrderObj.diaChi = vIpDiaChi;
    paramOrderObj.loiNhan = vIpLoiNhan;

    $("#input-modal-id").val(paramOrderObj.order.orderCode);
  }
</script>
</html>